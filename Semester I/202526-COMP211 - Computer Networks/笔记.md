# COMP211-202526 Computer Network

---

[TOC]

---

# 课程介绍

## [1] 分数组成

| 项目            | 占比 | 说明                  |
| --------------- | ---- | --------------------- |
| A1 JAVA Project | 10%  | DDL 17 October, 17:00 |
| A2 JAVA Project | 10%  | DDL 31 October, 17:00 |
| Exam            | 80%  | 2小时50个选择题       |

## [2] 教学大纲

| **Weeks 周次** | **Topics 主题**            | **Textbook Chapters 教科书章节** |
| -------------- | -------------------------- | -------------------------------- |
| 1              | Introduction 简介          | KR1, T1                          |
| 1.5            | Application Layer 应用层   | KR2, T7                          |
| 2              | Transport Layer 传输层     | KR3, T6                          |
| 1.5            | Network Layer 网络层       | KR4, KR5, T5                     |
| 1.5            | Link Layer 链路层          | KR6, KR7, T2.1, T3.2             |
| 1.5            | Internet Security 网络安全 | KR8, T8                          |

课程侧重探讨：互联网的架构（architecture）和协议（protocols）为主要工具来研究**计网的基本概念**。

学习成果：

1. 描述+论证（Describe  + Justify）OSI参考模型、计网**关键协议**
2. 网络编程
3. 加密技术

# Introduction

## [1] 互联网构成

### [1.1] 组件视角

互联网的组件视角由以下四方面组成：

1. 终端系统（主机）：互联网数据的**发送端和接收端，是边缘设备/网络边缘（Network Edge）。**

   > 终端系统：End System
   >
   > 主机：hosts

2. 分组交换机（Packet switches）：路由器（routers）+交换机（switches）组成。负责转发数据块。

3. 通信线路：例如铜线光纤等。

4. 网络：由相互连接的互联网服务提供商（ISP）构成。

   > Internet Server Provider

### [1.2] 协议视角

**协议的定义：**协议定义了网络中设备间通信的规则，定义了：

1. 消息的格式
2. 发送与接收顺序
3. 消息传输或接收时应采取的操作



**计网协议的作用：**贯穿互联网，控制消息的发送与接收，常见协议有 **HTTP**（网页）、**TCP**、**IP**、**WiFi**、**4/5G**、**以太网**等。

**协议标准体系：**由互联网工程任务组制定，以 “请求评论”（RFC）文档形式发布，确保互联网技术规范统一。

> 互联网工程任务组 Internet Engineering Task Force IETF。
>
> RFC - Request For Comment

## [2] 互联网结构

### [2.1] 网络边缘

网络边缘（Network Edge）、网络设备、终端（Network End）、主机（Hosts）可以理解为一个意思。网络边缘有：客户端（各种设备）、服务器。

网络边缘的特点就是：他们**不是**主要**转发网络的中转站**。

<img src="./imageResource/image-20250925111640090.png" alt="image-20250925111640090" style="zoom:25%;" />



### [2.2] 接入网

接入网（Access Network）

---

**第一种接入网形式是：电缆（Cable）接入**

<img src="./imageResource/image-20250925112438252.png" alt="image-20250925112438252" style="zoom: 33%;" />



- **Cable Headend（电缆前端）**：互联网连接核心枢纽。负责接收数据，收集用户发送的数据。（同时还承担着电视信号的处理、调制等工作）

- **Cable Modem（电缆调制解调器）**：它的作用是将用户设备（如电脑、电视等）产生的**数字信号转换为**适合在**电缆中传输的模拟信号** 或反之。

- **Cable Splitter（电缆分路器）**：用于将一根电缆的信号分配到多个用户端，这样多个用户可以共享同一段电缆线路，同时不影响各自信号的传输。

  > Cable Splitter 下行（从headend到end）中是直接分配即可，可同时共享。
  >
  > Cable Splitter 上行（从end到headend）中是使用**频分复用（FDM）**技术（如图，分为9个Channel，每个Channel互不影响）：不同信号在不同频段传输。对于这个FDM技术，请查看 **[频分复用](#3_2_2_what_is_fdm_and_tdm)**

<img src="./imageResource/image-20250925113401450.png" alt="image-20250925113401450" style="zoom: 50%;" />

上面这张图是**混合光纤同轴（Hybrid Fiber Coax，HFC）网络**（也是基于电缆接入网络），它是有线电视网络（CATV）用于提供互联网接入等宽带服务的典型架构。

HFC网有非对称性：下行速率 40 Mbps - 1.2 Gbps，上行速率 30 - 100 Mbps

更详细一步、CMTS同时处理电视信号和ISP（网络服务提供商）的信号，整合到一起。

> CMTS（Cable Modem Termination System，电缆调制解调器终端系统）：
>
> 整合如下信号：
>
> - 电视信号频率：50 - 550MHz
> - ISP信号频率：550-750MHz

此处有光纤和电缆的转换。

---

**第二种接入网形式是：数字用户线路（DSL - Digital Subscriber Line）接入**

<img src="./imageResource/image-20250925114315938.png" alt="image-20250925114315938" style="zoom: 33%;" />

DSL 是一种利用现有**电话线路**向用户提供宽带互联网接入和传统语音通信的技术。

**用户端设备**：

- **DSL Modem（DSL 调制解调器）**：数字信号、语音信号 互转。
- **Splitter（分路器）**：用于分离电话线路中的语音信号和数据信号，使语音通话和宽带上网可以同时进行且互不干扰。

**中心局设备**：

- **Central Office（中心局）**：电话公司的核心节点，集中了 DSLAM 等设备，是电话线路和网络的交汇点。
- **DSLAM（DSL Access Multiplexer，DSL 接入复用器）**：**位于电话公司的中心局**，负责汇聚多个用户的 DSL 连接，将用户的数据信号转发到互联网服务提供商（ISP）的网络，同时将语音信号转发到电话网络。

---

**第三种接入网形式是：家庭网（Home Networks）接入**

<img src="./imageResource/image-20250925115921836.png" alt="image-20250925115921836" style="zoom:33%;" />



家庭网这里有**无线网（Wireless Access Network）接入**，分为两种

1. 无线局域网（WiFi）

   > Wireless local area networks

2. 广域蜂窝接入网络（流量）

   > Wide-area cellular access networks
   >
   > 4G: 150/300 Mbps (15km)
   >
   > 5G: 10Gbps (300m)

---

**第四种接入网形式是：企业网（Enterprise Network）接入**

<img src="./imageResource/image-20250925120744526.png" alt="image-20250925120744526" style="zoom: 33%;" />



企业网内部有很多交换机、无线网，但是输出一般都是经过汇总的。

---

**第五种接入网形式是：数据中心网（Data Center Network）接入**

把各服务器链接，通常10s - 100s （数十到数百）Gbps。

### [2.3] 物理介质

> Link 链路， 也就是传输数据线 

- 主机（Hosts）接收应用程序消息
- 将其拆分为更小的块，即长度为 $L$ 位的**数据包（Packets）**
- 以传输速率（Transmission Rate） $R$ 将数据包传输到接入网络
  - 链路传输速率（Transmission Rate），也称为**链路容量（Link Capacity）**，或称**链路带宽（Link Bandwidth）**

$$
数据包传输延迟 = 将 L 位的数据包传输到链路所需的时间 = \dfrac{L(位)}{R(位 / 秒)}
$$

- bit是数据传输的基本单位。
- 物理链路（physical link）：指发射机和接收机之间的物理连接部分，是数据传输的物理通道。

- **导引型介质（guided media）**：信号在固体介质中传播，常见的固体介质有**铜缆（如双绞线）**、**光纤**、**同轴电缆**等。这些介质能 “引导” 信号在固定的路径内传输。
- **非导引型介质（unguided media）**：信号可以自由传播，例如无线电（像 WiFi、手机通信使用的无线电波等），不需要固体介质来引导信号，信号在空间中传播。



**引导型介质例子：**

---

> **引导型介质：双绞线 Twisted pair (TP)**
>
> <img src="./imageResource/image-20250925122228412.png" alt="image-20250925122228412" style="zoom:33%;" />
>
> 5类线：100Mbps和1Gbps**以太网（Ethernet）**
> 6类线：能支持 10 Gbps 的以太网传输
>
> ---
>
> **引导型介质：同轴电缆 Coaxial cable**
>
> <img src="./imageResource/image-20250925122828719.png" alt="image-20250925122828719" style="zoom:50%;" />
>
> **结构**：由两根同心的铜质导体组成（内层铜芯传输信号，外层铜质屏蔽层起到抗干扰等作用）。
>
> **传输特性**：
>
> - **双向性（bidirectional）**：能同时进行双向的数据传输，即可以同时发送和接收数据。
> - **宽带特性（broadband）**：
>   - 电缆上可存在多个频率通道（multiple frequency channels on cable），不同的频率通道可用于传输不同的信号或数据。
>   - 每个通道能支持每秒数百兆比特（100’s Mbps per channel）的传输速率。
>
> ---
>
> **引导型介质：光纤（Fiber optic cable）**
>
> <img src="./imageResource/image-20250925122955189.png" alt="image-20250925122955189" style="zoom:25%;" />
>
> - **传输原理**：通过玻璃纤维传输光脉冲，每个光脉冲代表一个比特（bit）。
> - **优势特点**：
>   - **高速运行（high - speed operation）**：
>     - 支持高速的点对点传输（high - speed point - to - point transmission），传输速率可达数十吉比特每秒到数百吉比特每秒（10’s - 100’s Gbps）。
>   - **低错误率（low error rate）**：
>     - 中继器（repeaters，用于放大或再生信号以延长传输距离）的间隔可以很大（repeaters spaced far apart）。
>     - 不受电磁噪声（electromagnetic noise）的影响，因为是通过光信号传输，而非电信号，所以电磁干扰对其传输质量影响极小。

---





**非引导型介质例子：**

---

**无线射频（Wireless radio）**

- **信号传输**：信号在**电磁波谱（Electromagnetic Spectrum）**的不同 “**频段（Bands）**” 中传输（Carried），利用无线电波（Ratio waves）来传递数据。
- **无物理线路**：不需要像网线、光纤那样的物理 “导线（wire）”，通过空气等空间介质传输信号。
- **传输方式**：采用 **广播、半双工（broadcast, “half - duplex”） 模式**，即信号从发送方到接收方单向广播，同一时间通常只能进行 “发送” 或 “接收” 操作（不能同时双向传输）。
- **传播环境影响**：无线信号的传输会受到多种环境因素影响：
  - **反射（reflection）**：信号遇到物体（如建筑物、山脉）会反射，可能导致信号叠加或失真。
  - **物体遮挡（obstruction by objects）**：树木、墙壁等物体遮挡会削弱信号强度。
  - **干扰 / 噪声（Interference/noise）**：其他无线信号或电磁噪声会干扰传输，影响信号质量。



**无线射频链路类型（Radio link types）**

- **无线局域网（Wireless LAN, WiFi）**：
  - 传输速率：10 - 数百 Mbps（10 - 100’s Mbps）。
  - 覆盖范围：数十米（10’s of meters），适用于家庭、办公室等小范围无线组网。
- **广域无线（wide - area，如 4G/5G 蜂窝网络）**：
  - 以 4G 为例，传输速率约数十 Mbps（10’s Mbps），覆盖范围可达约 10 公里，用于大范围的移动网络接入。
- **蓝牙（Bluetooth）**：
  - 定位：“线缆替代方案（cable replacement）”，用于短距离设备间的无线连接（如耳机与手机、键盘与电脑）。
  - 特点：短距离（short distances）、传输速率有限（limited rates）。
- **地面微波（terrestrial microwave）**：
  - 传输方式：**点对点（point - to - point）**，常用于固定地点间的高速数据传输。
  - 单通道速率：45 Mbps 的通道（45 Mbps channels）。
- **卫星（satellite）**：
  - 以星链（Starlink）为例，下行速率可达不到 100 Mbps。
  - 延迟：地球同步卫星的端到端延迟约 270 毫秒（270 msec end - end delay (geostationary)），信号往返卫星的距离远，导致延迟较高。





## [3] 网络核心

Network Core

### [3.1] 网络结构的核心

**网络核心的结构**：

- 是**相互连接的路由器组成的网状结构**。

- 从示意图能看到，不同类型的网络（家庭网络、企业网络、移动网络等）通过各级 ISP（本地 / 区域 ISP、全国 / 全球 ISP）的路由器网络相互连通。

  <img src="./imageResource/image-20250925124358696.png" alt="image-20250925124358696" style="zoom: 33%;" />

> mesh - 网状结构
>
> interconnected  - 相互连接的
>
> routers - 路由器



- **分组交换（packet - switching）**：
  - 主机（hosts）会把应用层的消息拆分成**分组（packets）**。
  - 网络通过 “逐跳转发” 的方式，将分组从一个路由器传递到下一个路由器，沿着从源地址到目的地址的路径传输。

### [3.2] 网络核心的两大关键功能

网络核心有两个核心操作：**转发（Forwarding）**和 **路由（Routing）**，二者协同实现数据的高效传输。

<img src="./imageResource/image-20250925124839029.png" alt="image-20250925124839029" style="zoom:33%;" />

#### [3.2.1] 转发/交换 Forwarding/Switching

- 性质：**本地操作（local action）**，即每个路由器独立完成的动作。
- 功能：根据路由器的**本地转发表（local forwarding table）**，将到达路由器输入链路的分组，移动到合适的输出链路。
- 示例：图中显示，当带有目的地址的分组到达路由器时，路由器查看转发表（根据分组头部的 “header value” 匹配 “output link”），把分组转发到对应的输出链路。

##### 分组的交换

**分组转发/交换 （Packet-switching）** 一共两步骤

---

**步骤一、储存转发（Store-and-forward）**

<img src="./imageResource/image-20250929110548222.png" alt="image-20250929110548222" style="zoom:50%;" />

这里的Packet是分组的意思。

分组传输延迟公式：
$$
\text{Packet Transmission Delay}=\dfrac{L}{R}
$$
其中 $L$ 是：每个分组 $L$ 比特。

端源（Source，也就是发送者）速率是 $R$ 比特$/sec$ 

目的端（Destination，也就是接收方）速率也是 $R$ 比特$/sec$ 

---

**步骤二、排队（Queueing）**

储存后，我们需要转发，把这些转发的东西看作工作（Work）。当工作的到达速度 $>$ 处理速度的时候，就会在路由器那里发生排队。

<img src="./imageResource/image-20250929111237003.png" alt="image-20250929111237003" style="zoom:33%;" />

丢包：如果排队队伍过长，路由器缓冲区满了（Buffer），那么后面新来的排队的就会发生**丢包**。

##### 电路的交换

<img src="./imageResource/image-20250929112714379.png" alt="image-20250929112714379" style="zoom:33%;" />

电路交换的关键在于为通信的两端（源和目的）在整个通信过程中，**预先分配并独占端到端的资源**。就像打电话时，从你拨号开始，到通话结束挂断，这条通话的 “电路” 资源（包括沿途的链路、交换机的处理资源等）是专门为你和对方预留的，**不会被其他通信占用**。

从源设备（图中上方的计算机）到目的设备（图中下方的计算机）的 “呼叫”（可以理解为一次通信连接，比如传统的电话呼叫），会被分配并预留端到端的资源。这里的 “端到端（End-to-End）” 意味着**从源到目的的整个通信路径上的资源都被预留**。例如上图$\color{red}\bold{\text{红色线}}$。



此外，一个很明显的问题就是：电缆就这么多，但是数据越来越多，怎么才能让一根电缆利用率达到极致呢？

因此引入了**频分复用（FDM）**和**时分复用（TDM）**技术！

<a id="3_2_2_what_is_fdm_and_tdm"></a>

#### [3.2.2] FDM 和 TDM

---

**FDM - Frequency Division Multiplexing 频分复用** ：

1. 光、电磁频率被划分为（窄）频段
2. 每个呼叫分配有**自己的频段**，能够以该窄带的最大速率进行传输

![image-20250930161206939](./imageResource/image-20250930161206939.png)

---

**TDM - Time Division Multiplexing 时分复用：** 

时间被划分为多个时隙，每个呼叫被分配到周期性的时隙，只能在其时隙内以（更宽的）频段的最大速率进行传输

<img src="./imageResource/image-20250930161305698.png" alt="image-20250930161305698" style="zoom:110%;" />

---

**FDM和TDM对比**

| 对比维度         | FDM                                                          | TDM                                                          |
| ---------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **信号类型**     | 主要传输**模拟信号**，需通过调制技术将信号映射到对应频段     | 主要传输**数字信号**，依赖时间片分割与排序实现复用           |
| **资源分配核心** | 以“**频段**”为单位分配资源，每个用户长期占用固定频段         | 以“**时间片**”为单位分配资源，每个用户周期性占用固定时间片   |
| **关键技术要求** | 需大量滤波器（分离不同频段）、调制解调器，**且需预留“保护带宽”（防止频段间干扰）** | 需高精度**时钟同步**（确保时间片分配与接收准确），需缓存器暂存不同时间片的数据 |
| **资源浪费情况** | **保护带宽会占用部分信道资源，导致频谱利用率降低；**若用户无数据，其频段仍空闲 | 无数据传输的用户，其专属时间片会直接空闲                     |
| **抗干扰能力**   | 抗干扰能力较弱，易受频段重叠、信道非线性失真影响             | 抗干扰能力较强，仅需保证时钟同步，信号在时域分离不易相互干扰 |
| **典型应用场景** | **传统广播/电视、有线电视网络**、早期模拟电话系统、卫星通信的多频段传输 | **数字电话系统（如E1/T1线路）、计算机网络骨干链路**、IP电话实时语音传输、工业数据采集 |
| **设备复杂度**   | 设备复杂（需处理多频段滤波与调制），成本较高                 | 设备相对简单（核心是时钟同步与时间片调度），但对同步精度要求极高 |

#### [3.2.3] 分组交换和电路交换例题

> [!CAUTION]
>
> ### ==重要提醒：数量级区分==
>
> 计算机存储（硬盘、内存）中，$\text{KB、MB、GB、TB}$ 数量级是$2^{10}=1024$
>
> 通信带宽（链路、网络速率）中，数量级是 $10^3=1000$，因此 $\text{1 Gbps = 1000 Mbps}$

假设：

<img src="./imageResource/image-20250930162328350.png" alt="image-20250930162328350" style="zoom:33%;" />

我们有 $\text{1 Gbps}$ 的链路（Link），每个用户 $\text{100 Mb/s}$ 的峰值（例如他们在下载电影），但是一天中只有$10\%$的时间在下电影。

问：在分组交换、电路交换两种情况下，这个网络能供给多少个用户使用呢？

答：

1. 对于电路交换而言，是固定的，只能10个用户，因为
   $$
   n=\dfrac{1Gbps}{100Mbps}=\dfrac{1\times10^{3}Mbps}{100Mbps}=10
   $$
   电路交换相当于是专属VIP，用、不用都是占有一条唯一的专属线路

2. 对于分组交换而言，知道答案还需要一个条件：降网的概率不大于0.0004。

   因为对于分组交换而言，其实其最大占有量也只能是10个用户，但是关键在于线路是共享的，也就是用户A不用的时候用户B就可以用，因此我们需要计算出总人数 $n$，尝试计算出 $n$ 个人中某时间在线的人数大于 $10$ 个人的概率。

   这个是经典的二项分布题目，每个人都是独立的，活跃概率 $p=0.1$，对于二项分布 *X ~ Binomial $(n,p)$* 而言，二项分布算的是：在35次独立试验中，每次成功的概率为0.1的情况下，成功次数不超过10次的概率
   $$
   P(X=k) = P(n,k)p^k(1-p)^{n-k}
   $$
   因此

#### [3.2.4] 路由 Routing 

- 性质：**全局操作（global action）**，需要考虑整个网络的拓扑结构。
- 功能：确定分组从源地址到目的地址所走的路径。
- 实现：通过**路由算法（Routing Algorithms）**来计算最优路径，并将路径信息更新到各个路由器的本地转发表中，为转发操作提供依据。



<img src="./imageResource/image-20250925124939544.png" alt="image-20250925124939544" style="zoom: 15%;" />





<img src="./imageResource/image-20250925125009006.png" alt="image-20250925125009006" style="zoom:15%;" />



